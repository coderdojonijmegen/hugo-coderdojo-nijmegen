<!doctype html><html lang=nl-nl><head><title>Python - Raspberry Pi</title>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=mobile-web-app-capable content="yes"><link rel=stylesheet href=/css/style.min.ac8531ed4f389289658d568cdefcf4ec40c2fa59fb3c120a919ac7906cbc344b.css><link rel=icon href=/imgs/icon-512x512.png><meta property="og:title" content="CoderDojo Nijmegen - Python - Raspberry Pi"><meta property="og:type" content="website"><meta property="og:image" content="https://coderdojo-nijmegen.nl/imgs/logo_coderdojo_nijmegen-zwart.png"><meta property="og:url" content="https://coderdojo-nijmegen.nl/instructies/python-raspberry-pi/"></head><body><header class=teal-background><menu><span class=menu-toggle id=js-menu-toggle><i></i>
<i></i>
<i></i>
</span><logo><a href=/><img src=/imgs/logo_coderdojo_nijmegen.png alt="logo CoderDojo"></a></logo><ul id=js-menu class=menu><li><a href=/dojos/>dojos</a></li><li><a href=/instructies/>instructies</a></li><li><a href=/onderwerpen/>onderwerpen</a></li><li><a href=/meehelpen/>meehelpen</a></li><li><a href=/team/>team</a></li><li><a href=/stichting/>stichting</a></li><li><a href=/zoeken/>zoeken</a></li></ul></menu></header><main><breadcrumbs><ul><li><a href=/>home</a></li><li>/ <a href=/instructies>instructies</a></li><li>/ <a href=/instructies/python-raspberry-pi>python-raspberry-pi</a></li></ul></breadcrumbs><h1>Python - Raspberry Pi</h1><article class=instructie><aside class=toc><header><h2>Inhoud</h2></header><nav id=TableOfContents><ul><li><a href=#de-raspberry-pi-aansluiten>De Raspberry Pi aansluiten</a></li><li><a href=#de-software>De software</a></li><li><a href=#een-led-aansturen>Een led aansturen</a></li><li><a href=#een-led-met-een-schakelaar>Een led met een schakelaar</a></li><li><a href=#bewegingssensor-en-buzzer>Bewegingssensor en buzzer</a></li><li><a href=#stappenmotor>Stappenmotor</a></li><li><a href=#afstandssensor>Afstandssensor</a><ul><li><a href=#aansluiten>Aansluiten</a></li><li><a href=#software-schrijven>Software schrijven</a></li><li><a href=#zelf-proberen>Zelf proberen</a></li></ul></li><li><a href=#bron>Bron</a></li></ul></nav></aside><p>Een Raspberry Pi is een mini-computer waar je allerlei leuke dingen mee kunt doen.
Je kan de Raspberry Pi als computer gebruiken.
Daarnaast kun je er ook allerlei apparaatjes en elektronische schakelingen aan koppelen.</p><p>We gaan met bewegingssensoren, afstandssensoren en een stappenmotor aan de slag.</p><h2 id=de-raspberry-pi-aansluiten>De Raspberry Pi aansluiten</h2><p><img src=pi%20aansluiten.png alt="Pi aansluiten"></p><p>Zoals hierboven genoemd is een Raspberry Pi een mini-computer,
waar je net als een gewone computer een scherm, toetsenbord en muis op moet aansluiten.
Via de volgende stappen bereiden we de Raspberry Pi voor op gebruik:</p><ol><li>In de doos van de Raspberry Pi zit een HDMI-kabel die je op het scherm aansluit en op aansluiting 1.</li><li>Op USB aansluitingen 2 en 3 sluit je het toetsenbord en de muis aan.</li><li>Tenslotte pak je de voeding uit de doos en sluit je deze aan op aansluiting 4 en in het stopcontact.</li></ol><p>Zodra je de stroom hebt aangesloten, begint de Raspberry Pi op te starten. Als het scherm aanstaat, kan je zien hoe de computer opstart.</p><h2 id=de-software>De software</h2><p>De Raspberry Pi&rsquo;s die we gebruiken zijn al wat ouder en daardoor niet zo snel.
We gebruiken daarom de webbrowser niet, maar werken alleen met editor <strong>MousePad</strong> en de terminal.
Deze zijn te zien op de volgende afbeelding:</p><p><img src=screenshot_dietpi_mousepad_LXTerminal.jpg alt="Mousepad en LXTerminal"></p><p>Met MousePad maken we de *.py bestanden met daarin de code.
Vervolgens voeren we die uit in de terminal met het commando:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo python3 &lt;scriptnaam&gt;.py
</span></span></code></pre></div><h2 id=een-led-aansturen>Een led aansturen</h2><p>We gaan beginnen met het aanzetten van een led lampje met de Raspberry Pi. Hiervoor hebben we nodig:</p><ol><li>Een led lampje</li><li>Een weerstandje (330 ohms)<br><svg width="300" height="100" viewBox="0 0 402 140" fill="none" xmlns="http://www.w3.org/2000/svg" class="max-w-full"><g fill="#fee3b5" stroke="#000" stroke-width="1.5"><path d="M51 31V71L36 56V46L51 31z"/><path d="M351 71V31l15 15V56L351 71z"/><rect x="91" y="11" width="220" height="80"/><rect x="311" y="1" width="40" height="100" rx="3"/><rect x="51" y="1" width="40" height="100" rx="3"/><rect x="366" y="48" width="35" height="6"/><rect x="1" y="48" width="35" height="6"/></g><g transform="translate(91 11)"><g><title>Orange (OG)</title><rect x="10" y="0" width="15" height="80" fill="orange" stroke="#000" stroke-width="1.5"/><rect x="16.5" y="80" width="2" height="20" fill="#000"/><rect x="7" y="100" width="21" height="22" rx="3" fill="orange" stroke="#000"/><text x="17.5" y="116" text-anchor="middle" font-size="14" fill="#000" class="font-medium">3</text></g><g><title>Orange (OG)</title><rect x="35" y="0" width="15" height="80" fill="orange" stroke="#000" stroke-width="1.5"/><rect x="41.5" y="80" width="2" height="20" fill="#000"/><rect x="32" y="100" width="21" height="22" rx="3" fill="orange" stroke="#000"/><text x="42.5" y="116" text-anchor="middle" font-size="14" fill="#000" class="font-medium">3</text></g><g><title>Black (BK)</title><rect x="60" y="0" width="15" height="80" fill="#000" stroke="#000" stroke-width="1.5"/><rect x="66.5" y="80" width="2" height="20" fill="#000"/><rect x="57" y="100" width="21" height="22" rx="3" fill="#000" stroke="#000"/><text x="67.5" y="116" text-anchor="middle" font-size="14" fill="#fff" class="font-medium">0</text></g><g><title>Black (BK)</title><rect x="85" y="0" width="15" height="80" fill="#000" stroke="#000" stroke-width="1.5"/><rect x="91.5" y="80" width="2" height="20" fill="#000"/><rect x="82" y="100" width="60" height="22" rx="3" fill="#000" stroke="#000"/><text x="112" y="116" text-anchor="middle" font-size="14" fill="#fff" class="font-medium">×1Ω</text></g><g><title>Gold (GD)</title><rect x="160" y="0" width="25" height="80" fill="gold" stroke="#000" stroke-width="1.5"/><rect x="171.5" y="80" width="2" height="20" fill="#000"/><rect x="146" y="100" width="50" height="22" rx="3" fill="gold" stroke="#000"/><text x="171" y="116" text-anchor="middle" font-size="14" fill="#000" class="font-medium">±5%</text></g></g></svg><br>plaatje van: <a href=https://resistorcolorcodes.com>https://resistorcolorcodes.com</a></li><li>Een paar draadjes</li><li>Een breadboard</li></ol></br><p>We gaan nu eerst de draadjes aansluiten, hoe dat moet is te zien op de afbeelding hieronder.
We verbinden de 3.3 volt aansluiting op de Raspberry Pi met de onderste rij op het breadboard.
We verbinden de GROUND met de rij erboven op het breadboard. Daarna pluggen we de weerstand en het ledje in zoals het op de afbeelding staat.
Als laatste verbinden we de weerstand en het ledje met de rijen op het breadboard, en het bruine draadje met de controller pin op de Raspberry Pi.</br></br>De pins op de afbeelding zijn hetzelfde als op jouw Raspberry Pi, je kan dus tellen waar de draadjes horen te zitten!</p><p><img src=LED%20on%20Pi_bb.png alt="led op Pi"></p><p>Het led lampje gaat nu nog niet branden, dat komt omdat het circuit nog niet compleet is.
We hebben net de led aangesloten op de GND en op de controller pin met het bruine draadje.
Om het circuit compleet te maken en het ledje aan te laten gaan moeten we de controller pin aanzetten.
De pin die wij hebben gebruikt heet <code>pin 18</code>. We moeten dus met code <code>pin 18</code> gaan aanzetten.
Dit dit we in Python als volgt:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>gpiozero</span> <span style=color:#000;font-weight:700>import</span> LED
</span></span><span style=display:flex><span>led <span style=color:#000;font-weight:700>=</span> LED(<span style=color:#099>18</span>)
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>while</span> <span style=color:#000;font-weight:700>True</span>:
</span></span><span style=display:flex><span>    led<span style=color:#000;font-weight:700>.</span>on()
</span></span></code></pre></div><p>De bovenstaande code begint met het importeren van de code (<code>gpiozero</code>) om de pin te besturen.
Hierna zeggen we dat er een ledje zit op <code>pin 18</code> met de regel code: <code>LED(18)</code>.
Daarna zetten we deze led aan. Start het script met:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 script.py
</span></span></code></pre></div><p>Het ledje zou nu moeten aangaan.</br></br></p><p>We kunnen het ledje laten knipperen door ons script te vervangen met het volgende script:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>gpiozero</span> <span style=color:#000;font-weight:700>import</span> LED
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>time</span> <span style=color:#000;font-weight:700>import</span> sleep
</span></span><span style=display:flex><span>led <span style=color:#000;font-weight:700>=</span> LED(<span style=color:#099>18</span>)
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>while</span> <span style=color:#000;font-weight:700>True</span>:
</span></span><span style=display:flex><span>    led<span style=color:#000;font-weight:700>.</span>on()
</span></span><span style=display:flex><span>    sleep(<span style=color:#099>1</span>)
</span></span><span style=display:flex><span>    led<span style=color:#000;font-weight:700>.</span>off()
</span></span><span style=display:flex><span>    sleep(<span style=color:#099>1</span>)
</span></span></code></pre></div><p>Dit werkt door de led steeds aan- en uit te zetten.
Tussendoor pauzeren we het programma met <code>sleep(1)</code>.
Door het getal hier aan te passen kan je de led sneller of langzamer laten knipperen.
Probeer bijvoorbeeld <code>sleep(5)</code> uit!</p><h2 id=een-led-met-een-schakelaar>Een led met een schakelaar</h2><p>De volgende stap is het toevoegen van een echte knop om de led mee te bedienen. Hiervoor moeten we eerst het onderstaande circuit nabouwen.
Dit circuit is al wat lastiger, vraag daarom gerust om hulp als je deze nodig hebt!</br></p><p><img src=LED%20and%20switch%20on%20Pi_bb.png alt="led en schakelaar op Pi"></p><p>De knop is aangesloten op <code>pin 2</code> (met het gele draadje op de afbeelding). Als je de knop indrukt is het circuit compleet en staat er spanning op <code>pin 2</code>. Dit kunnen wij uitlezen met Python:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>gpiozero</span> <span style=color:#000;font-weight:700>import</span> Button
</span></span><span style=display:flex><span>button <span style=color:#000;font-weight:700>=</span> Button(<span style=color:#099>2</span>)
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>while</span> <span style=color:#000;font-weight:700>True</span>: 
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>if</span> button<span style=color:#000;font-weight:700>.</span>is_pressed: 
</span></span><span style=display:flex><span>        <span style=color:#0086b3>print</span>(<span style=color:#d14>&#34;Button is pressed&#34;</span>) 
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#0086b3>print</span>(<span style=color:#d14>&#34;Button is not pressed&#34;</span>)
</span></span></code></pre></div><p>Dit script laat wat op je scherm zien als je de knop indrukt. Net zoals eerst vertellen we dat er een knop op <code>pin 2</code> zit met de regel: <code>Button(2)</code>.
De led doet het nu niet meer, deze sturen we namelijk niet maar aan in het script. We combineren nu ons script van net met dit script:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>gpiozero</span> <span style=color:#000;font-weight:700>import</span> LED, Button
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>signal</span> <span style=color:#000;font-weight:700>import</span> pause
</span></span><span style=display:flex><span>led <span style=color:#000;font-weight:700>=</span> LED(<span style=color:#099>18</span>)
</span></span><span style=display:flex><span>button <span style=color:#000;font-weight:700>=</span> Button(<span style=color:#099>2</span>)
</span></span><span style=display:flex><span>button<span style=color:#000;font-weight:700>.</span>when_pressed <span style=color:#000;font-weight:700>=</span> led<span style=color:#000;font-weight:700>.</span>on
</span></span><span style=display:flex><span>button<span style=color:#000;font-weight:700>.</span>when_released <span style=color:#000;font-weight:700>=</span> led<span style=color:#000;font-weight:700>.</span>off
</span></span><span style=display:flex><span>pause()
</span></span></code></pre></div><h2 id=bewegingssensor-en-buzzer>Bewegingssensor en buzzer</h2><p>Behalve de led en de knop zijn er natuurlijk veel meer apparaten die we kunnen aansluiten op een Raspberry PI. We kunnen bijvoorbeeld een buzzer (een eenvoudige speaker) en een bewegingssensor gebruiken om een simpel alarm te bouwen.
Als het alarm iemand ziet bewegen dan gaat het af!</br></br></p><p>Zoals voorheen bouwen we eerst het circuit op de foto na. Let goed op dat alle draadjes op de juiste plek zitten!</p><p><img src=pir-sensor-aansluiten.jpg alt="aansluitingen bewegingssensor"></p><p>Aansluiten van de PIR sensor boven en die van de buzzer beneden:</p><p><img src=buzzer.jpg alt=buzzer></p><div class=verdieping><strong>Let op</strong>: helaas zijn we er gisteren achter gekomen dat we maar 1 exemplaar van deze buzzer hebben&mldr; ☹️<br>Vraag één van de mentoren of je het even mag gebruiken om te testen. Gebruik verder het LEDje om te zien of de sensor
beweging heeft gedetecteerd.</div><p><img src=Motion%20and%20buzzer%20on%20Pi_bb.png alt="bewegingssensor en buzzer op Pi"></p><p>Het circuit werkt als volgt: als de bewegingssensor iets ziet bewegen, geeft deze een stroompje af op het draadje dat we hebben aangesloten op de pins van de Raspberry Pi.
Dit stroompje kunnen wij detecteren met onze code, en vervolgens kunnen we de buzzer geluid laten maken door stroom te zetten op de pin waar de buzzer op is aangesloten.<br>Om het alarm nog effectiever te maken kunnen we ook de led laten knipperen.<br><br>We kunnen de bewegingssensor als volgt gebruiken in de code:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>gpiozero</span> <span style=color:#000;font-weight:700>import</span> MotionSensor
</span></span><span style=display:flex><span>pir <span style=color:#000;font-weight:700>=</span> MotionSensor(<span style=color:#099>23</span>)
</span></span><span style=display:flex><span>pir<span style=color:#000;font-weight:700>.</span>wait_for_motion()
</span></span><span style=display:flex><span><span style=color:#0086b3>print</span>(<span style=color:#d14>&#34;Motion detected!&#34;</span>)
</span></span></code></pre></div><p>Herken je de manier waarop we de deze code schrijven? Het is bijna hetzelfde als in de vorige voorbeelden. Deze keer zit de bewegingssensor (<code>MotionSensor</code>) aangesloten op <code>pin 23</code>.<br>Dit scriptje print <code>Motion detected!</code> als de sensor iets ziet bewegen.<br><br>We gaan deze code nu combineren met onze code om de led aan te sturen. Ook passen we dit toe op de buzzer. Het resultaat is als volgt:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>gpiozero</span> <span style=color:#000;font-weight:700>import</span> MotionSensor, Buzzer, LED
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>time</span>
</span></span><span style=display:flex><span>pir <span style=color:#000;font-weight:700>=</span> MotionSensor(<span style=color:#099>23</span>)
</span></span><span style=display:flex><span>bz <span style=color:#000;font-weight:700>=</span> Buzzer(<span style=color:#099>24</span>)
</span></span><span style=display:flex><span>led <span style=color:#000;font-weight:700>=</span> LED(<span style=color:#099>18</span>)
</span></span><span style=display:flex><span><span style=color:#0086b3>print</span>(<span style=color:#d14>&#34;Waiting for PIR to settle&#34;</span>)
</span></span><span style=display:flex><span>pir<span style=color:#000;font-weight:700>.</span>wait_for_no_motion()
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>while</span> <span style=color:#000;font-weight:700>True</span>:
</span></span><span style=display:flex><span>    led<span style=color:#000;font-weight:700>.</span>off()
</span></span><span style=display:flex><span>    <span style=color:#0086b3>print</span>(<span style=color:#d14>&#34;Ready&#34;</span>)
</span></span><span style=display:flex><span>    pir<span style=color:#000;font-weight:700>.</span>wait_for_motion()
</span></span><span style=display:flex><span>    led<span style=color:#000;font-weight:700>.</span>on()
</span></span><span style=display:flex><span>    <span style=color:#0086b3>print</span>(<span style=color:#d14>&#34;Motion detected!&#34;</span>)
</span></span><span style=display:flex><span>    bz<span style=color:#000;font-weight:700>.</span>beep(<span style=color:#099>0.5</span>, <span style=color:#099>0.25</span>, <span style=color:#099>8</span>)
</span></span><span style=display:flex><span>    time<span style=color:#000;font-weight:700>.</span>sleep(<span style=color:#099>3</span>)
</span></span></code></pre></div><p>Snap je hoe het werkt? Probeer eens wat waardes aan te passen!</p><h2 id=stappenmotor>Stappenmotor</h2><p>We hebben nu al een led, knop, sensor en buzzer aangesloten. Het volgende onderdeel is natuurlijk een motor. We gaan een zogeheten stappenmotor aansluiten op de sensor.</br></br>Het aansturen van een motor is wat ingewikkelder dan het aansturen van de andere onderdelen. Dat is ook logisch, want een ledje of of buzzer kan alleen aan of uit. Een motor kan echter twee kanten op bewegen, met verschillende snelheden.<br></br>Gelukkig hebben we een apart circuitje om ons daarmee te helpen. We gaan weer het circuitje nabouwen op de foto!
<img src=stepper%20motor%20on%20Pi_bb.png alt="stappenmotor op Pi"></p><p>Zoals je kan zien moeten er veel draadjes worden aangesloten voor de motor:</p><ul><li>twee draadjes voor 5 Volt en de GND;</li><li>vier draadjes om de motor instructies te sturen.</li></ul><p></br></br>Je kan de code hieronder gebruiken om de motor aan te sturen. Dit is complexe code! We raden het aan om een mentor om hulp te vragen als je dit beter wilt begrijpen.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>time</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>sys</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>gpiozero</span> <span style=color:#000;font-weight:700>import</span> OutputDevice <span style=color:#000;font-weight:700>as</span> stepper
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>IN1 <span style=color:#000;font-weight:700>=</span> stepper(<span style=color:#099>12</span>)
</span></span><span style=display:flex><span>IN2 <span style=color:#000;font-weight:700>=</span> stepper(<span style=color:#099>16</span>)
</span></span><span style=display:flex><span>IN3 <span style=color:#000;font-weight:700>=</span> stepper(<span style=color:#099>20</span>)
</span></span><span style=display:flex><span>IN4 <span style=color:#000;font-weight:700>=</span> stepper(<span style=color:#099>21</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>stepPins <span style=color:#000;font-weight:700>=</span> [IN1, IN2, IN3, IN4]  <span style=color:#998;font-style:italic># Motor GPIO pins</span>
</span></span><span style=display:flex><span>stepDir <span style=color:#000;font-weight:700>=</span> <span style=color:#000;font-weight:700>-</span><span style=color:#099>1</span>  <span style=color:#998;font-style:italic># Set to 1 for clockwise</span>
</span></span><span style=display:flex><span>              <span style=color:#998;font-style:italic># Set to -1 for anti-clockwise</span>
</span></span><span style=display:flex><span>mode <span style=color:#000;font-weight:700>=</span> <span style=color:#099>1</span>  <span style=color:#998;font-style:italic># mode = 1: Low Speed ==&gt; Higher Power</span>
</span></span><span style=display:flex><span>          <span style=color:#998;font-style:italic># mode = 0: High Speed ==&gt; Lower Power</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>if</span> mode:  <span style=color:#998;font-style:italic># Low Speed ==&gt; High Power</span>
</span></span><span style=display:flex><span>    seq <span style=color:#000;font-weight:700>=</span> [[<span style=color:#099>1</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>1</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>1</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>1</span>, <span style=color:#099>1</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>1</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>1</span>, <span style=color:#099>1</span>, <span style=color:#099>0</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>1</span>, <span style=color:#099>0</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>1</span>, <span style=color:#099>1</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>1</span>]]  <span style=color:#998;font-style:italic># Define step sequence as shown in manufacturers datasheet</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>else</span>:
</span></span><span style=display:flex><span>    seq <span style=color:#000;font-weight:700>=</span> [[<span style=color:#099>1</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>], 
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>1</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>], 
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>1</span>, <span style=color:#099>0</span>], 
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>1</span>]]  <span style=color:#998;font-style:italic># Define step sequence as shown in manufacturers datasheet</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>stepCount <span style=color:#000;font-weight:700>=</span> <span style=color:#0086b3>len</span>(seq)
</span></span><span style=display:flex><span>stepCounter <span style=color:#000;font-weight:700>=</span> <span style=color:#099>0</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>if</span> <span style=color:#0086b3>len</span>(sys<span style=color:#000;font-weight:700>.</span>argv) <span style=color:#000;font-weight:700>&gt;</span> <span style=color:#099>1</span>:  <span style=color:#998;font-style:italic># Read wait time from command line</span>
</span></span><span style=display:flex><span>    waitTime <span style=color:#000;font-weight:700>=</span> <span style=color:#0086b3>int</span>(sys<span style=color:#000;font-weight:700>.</span>argv[<span style=color:#099>1</span>]) <span style=color:#000;font-weight:700>/</span> <span style=color:#0086b3>float</span>(<span style=color:#099>1000</span>)
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>else</span>:
</span></span><span style=display:flex><span>    waitTime <span style=color:#000;font-weight:700>=</span> <span style=color:#099>0.004</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>while</span> <span style=color:#000;font-weight:700>True</span>:                          <span style=color:#998;font-style:italic># Start main loop</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>for</span> pin <span style=color:#000;font-weight:700>in</span> <span style=color:#0086b3>range</span>(<span style=color:#099>0</span>, <span style=color:#099>4</span>):
</span></span><span style=display:flex><span>      xPin <span style=color:#000;font-weight:700>=</span> stepPins[pin]  <span style=color:#998;font-style:italic># Get GPIO</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>if</span> seq[stepCounter][pin] <span style=color:#000;font-weight:700>!=</span> <span style=color:#099>0</span>:
</span></span><span style=display:flex><span>          xPin<span style=color:#000;font-weight:700>.</span>on()
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>else</span>:
</span></span><span style=display:flex><span>          xPin<span style=color:#000;font-weight:700>.</span>off()
</span></span><span style=display:flex><span>   stepCounter <span style=color:#000;font-weight:700>+=</span> stepDir
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>if</span> stepCounter <span style=color:#000;font-weight:700>&gt;=</span> stepCount:
</span></span><span style=display:flex><span>       stepCounter <span style=color:#000;font-weight:700>=</span> <span style=color:#099>0</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>if</span> stepCounter <span style=color:#000;font-weight:700>&lt;</span> <span style=color:#099>0</span>:
</span></span><span style=display:flex><span>       stepCounter <span style=color:#000;font-weight:700>=</span> stepCount <span style=color:#000;font-weight:700>+</span> stepDir
</span></span><span style=display:flex><span>   time<span style=color:#000;font-weight:700>.</span>sleep(waitTime)  <span style=color:#998;font-style:italic># Wait before moving on</span>
</span></span></code></pre></div><p>Omdat deze code zo lastig is leggen we het even in een paar onderdelen uit.</p><p></br></br>Eerst importeren we de juiste dingen. We importeren het OutputDevice, deze gebruiken we om de motor aan te sturen. Dit hernoemen we naar stepper zodat we het zo kunnen noemen in de code. Net zoals eerst zeggen op welke pins de draadjes zitten aangesloten. We stoppen deze pins in een lijst (stepPins), aangegeven met de [blokhaken].</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>time</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>sys</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>gpiozero</span> <span style=color:#000;font-weight:700>import</span> OutputDevice <span style=color:#000;font-weight:700>as</span> stepper
</span></span><span style=display:flex><span>IN1 <span style=color:#000;font-weight:700>=</span> stepper(<span style=color:#099>12</span>)
</span></span><span style=display:flex><span>IN2 <span style=color:#000;font-weight:700>=</span> stepper(<span style=color:#099>16</span>)
</span></span><span style=display:flex><span>IN3 <span style=color:#000;font-weight:700>=</span> stepper(<span style=color:#099>20</span>)
</span></span><span style=display:flex><span>IN4 <span style=color:#000;font-weight:700>=</span> stepper(<span style=color:#099>21</span>)
</span></span><span style=display:flex><span>stepPins <span style=color:#000;font-weight:700>=</span> [IN1, IN2, IN3, IN4]  <span style=color:#998;font-style:italic># Motor GPIO pins</span>
</span></span></code></pre></div><p></br></br></p><p>Hierna configureren we een aantal dingen, met stepDir geven we de richting van de motor aan (linksom of rechtsom).
Met de mode geven we aan hoe hard de motor draait. We kunnen kiezen tussen 1 en 0.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>stepDir <span style=color:#000;font-weight:700>=</span> <span style=color:#000;font-weight:700>-</span><span style=color:#099>1</span>  <span style=color:#998;font-style:italic># Set to 1 for clockwise</span>
</span></span><span style=display:flex><span>              <span style=color:#998;font-style:italic># Set to -1 for anti-clockwise</span>
</span></span><span style=display:flex><span>              
</span></span><span style=display:flex><span>mode <span style=color:#000;font-weight:700>=</span> <span style=color:#099>1</span>  <span style=color:#998;font-style:italic># mode = 1: Low Speed ==&gt; Higher Power</span>
</span></span><span style=display:flex><span>          <span style=color:#998;font-style:italic># mode = 0: High Speed ==&gt; Lower Power</span>
</span></span></code></pre></div><p></br></br></p><p>Op basis van de mode kiezen we een sequence. Dit is een reeks signalen die we naar de motor sturen om te zeggen wat hij moet doen.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>if</span> mode:  <span style=color:#998;font-style:italic># Low Speed ==&gt; High Power</span>
</span></span><span style=display:flex><span>    seq <span style=color:#000;font-weight:700>=</span> [[<span style=color:#099>1</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>1</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>1</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>1</span>, <span style=color:#099>1</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>1</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>1</span>, <span style=color:#099>1</span>, <span style=color:#099>0</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>1</span>, <span style=color:#099>0</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>1</span>, <span style=color:#099>1</span>],
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>1</span>]]  <span style=color:#998;font-style:italic># Define step sequence as shown in manufacturers datasheet</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>else</span>:
</span></span><span style=display:flex><span>    seq <span style=color:#000;font-weight:700>=</span> [[<span style=color:#099>1</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>], 
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>1</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>], 
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>1</span>, <span style=color:#099>0</span>], 
</span></span><span style=display:flex><span>            [<span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>0</span>, <span style=color:#099>1</span>]]  <span style=color:#998;font-style:italic># Define step sequence as shown in manufacturers datasheet</span>
</span></span></code></pre></div><p></br></br>Als laatste gaan we een voor een de signalen in de sequence (reeks) naar de motor te sturen.
Dit doen we in een while true, een oneindige loop. Hierdoor blijft de motor doordraaien.</br>We sturen de signalen naar alle 4 pins gebaseerd op de eerste regel in de sequence. Daarna pakken we de volgende regel en sturen die ook allemaal naar de pins. Hierdoor gaat de motor draaien.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>if</span> <span style=color:#0086b3>len</span>(sys<span style=color:#000;font-weight:700>.</span>argv) <span style=color:#000;font-weight:700>&gt;</span> <span style=color:#099>1</span>:  <span style=color:#998;font-style:italic># Read wait time from command line</span>
</span></span><span style=display:flex><span>    waitTime <span style=color:#000;font-weight:700>=</span> <span style=color:#0086b3>int</span>(sys<span style=color:#000;font-weight:700>.</span>argv[<span style=color:#099>1</span>]) <span style=color:#000;font-weight:700>/</span> <span style=color:#0086b3>float</span>(<span style=color:#099>1000</span>)
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>else</span>:
</span></span><span style=display:flex><span>    waitTime <span style=color:#000;font-weight:700>=</span> <span style=color:#099>0.004</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>while</span> <span style=color:#000;font-weight:700>True</span>:                          <span style=color:#998;font-style:italic># Start main loop</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>for</span> pin <span style=color:#000;font-weight:700>in</span> <span style=color:#0086b3>range</span>(<span style=color:#099>0</span>, <span style=color:#099>4</span>):
</span></span><span style=display:flex><span>      xPin <span style=color:#000;font-weight:700>=</span> stepPins[pin]  <span style=color:#998;font-style:italic># Get GPIO</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>if</span> seq[stepCounter][pin] <span style=color:#000;font-weight:700>!=</span> <span style=color:#099>0</span>:
</span></span><span style=display:flex><span>          xPin<span style=color:#000;font-weight:700>.</span>on()
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>else</span>:
</span></span><span style=display:flex><span>          xPin<span style=color:#000;font-weight:700>.</span>off()
</span></span><span style=display:flex><span>   stepCounter <span style=color:#000;font-weight:700>+=</span> stepDir
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>if</span> stepCounter <span style=color:#000;font-weight:700>&gt;=</span> stepCount:
</span></span><span style=display:flex><span>       stepCounter <span style=color:#000;font-weight:700>=</span> <span style=color:#099>0</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>if</span> stepCounter <span style=color:#000;font-weight:700>&lt;</span> <span style=color:#099>0</span>:
</span></span><span style=display:flex><span>       stepCounter <span style=color:#000;font-weight:700>=</span> stepCount <span style=color:#000;font-weight:700>+</span> stepDir
</span></span><span style=display:flex><span>   time<span style=color:#000;font-weight:700>.</span>sleep(waitTime)  <span style=color:#998;font-style:italic># Wait before moving on</span>
</span></span></code></pre></div><h2 id=afstandssensor>Afstandssensor</h2><h3 id=aansluiten>Aansluiten</h3><p>Met een ultrasoonsensor kun je de afstand van de sensor tot een object meten, bijvoorbeeld je hand. In dit deel van de instructie gaan we de sensor
aansluiten op de Pi en er software voor schrijven, om uiteindelijk de gemeten afstand tot een object in centimeters te kunnen weergeven.</p><p>In het onderstaande schema vind je de componenten en hoe je ze moet aansluiten.</p><p><img src=distance%20sensor%20on%20pi_bb.png alt="afstandssensor op Pi"></p><p>De weerstandjes zijn allemaal 1kOhm met kleurtjes bruin-zwart-rood.<br><svg width="300" height="100" viewBox="0 0 402 140" fill="none" xmlns="http://www.w3.org/2000/svg" class="max-w-full"><g fill="#fee3b5" stroke="#000" stroke-width="1.5"><path d="M51 31V71L36 56V46L51 31z"/><path d="M351 71V31l15 15V56L351 71z"/><rect x="91" y="11" width="220" height="80"/><rect x="311" y="1" width="40" height="100" rx="3"/><rect x="51" y="1" width="40" height="100" rx="3"/><rect x="366" y="48" width="35" height="6"/><rect x="1" y="48" width="35" height="6"/></g><g transform="translate(91 11)"><g><title>Brown (BN)</title><rect x="10" y="0" width="15" height="80" fill="brown" stroke="#000" stroke-width="1.5"/><rect x="16.5" y="80" width="2" height="20" fill="#000"/><rect x="7" y="100" width="21" height="22" rx="3" fill="brown" stroke="#000"/><text x="17.5" y="116" text-anchor="middle" font-size="14" fill="#fff" class="font-medium">1</text></g><g><title>Black (BK)</title><rect x="35" y="0" width="15" height="80" fill="#000" stroke="#000" stroke-width="1.5"/><rect x="41.5" y="80" width="2" height="20" fill="#000"/><rect x="32" y="100" width="21" height="22" rx="3" fill="#000" stroke="#000"/><text x="42.5" y="116" text-anchor="middle" font-size="14" fill="#fff" class="font-medium">0</text></g><g><title>Red (RD)</title><rect x="60" y="0" width="15" height="80" fill="red" stroke="#000" stroke-width="1.5"/><rect x="66.5" y="80" width="2" height="20" fill="#000"/><rect x="57" y="100" width="60" height="22" rx="3" fill="red" stroke="#000"/><text x="87" y="116" text-anchor="middle" font-size="14" fill="#fff" class="font-medium">×100Ω</text></g><g><title>Gold (GD)</title><rect x="160" y="0" width="25" height="80" fill="gold" stroke="#000" stroke-width="1.5"/><rect x="171.5" y="80" width="2" height="20" fill="#000"/><rect x="146" y="100" width="50" height="22" rx="3" fill="gold" stroke="#000"/><text x="171" y="116" text-anchor="middle" font-size="14" fill="#000" class="font-medium">±5%</text></g></g></svg></p><p>De ultrasoonsensor wordt gevoed vanuit 5Vdc, maar de IO-pinnen van de Pi ondersteunen maximaal 3.3Vdc. Daarom wordt
de <code>echo</code> spanning op het ultrasoon bordje gedeeld met de drie 1kOhm weerstandjes.</p><h3 id=software-schrijven>Software schrijven</h3><p>De code voor het gebruik van de afstandssensor is niet makkelijk in kleine onderdelen op te splitsen. Daarom vind je hieronder
het volledige script.<br>Onder de code vind je uitleg over de verschillende onderdelen.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#998;font-style:italic>#!/usr/bin/python3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>PRi.GPIO</span> <span style=color:#000;font-weight:700>as</span> <span style=color:#555>GPIO</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>time</span> <span style=color:#000;font-weight:700>import</span> sleep, time
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PIN_TRIGGER <span style=color:#000;font-weight:700>=</span> <span style=color:#099>7</span>
</span></span><span style=display:flex><span>PIN_ECHO <span style=color:#000;font-weight:700>=</span> <span style=color:#099>11</span>
</span></span><span style=display:flex><span>GELUIDSSNELHEID <span style=color:#000;font-weight:700>=</span> <span style=color:#099>34300</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>try</span>:
</span></span><span style=display:flex><span>    GPIO<span style=color:#000;font-weight:700>.</span>setmode(GPIO<span style=color:#000;font-weight:700>.</span>BOARD)
</span></span><span style=display:flex><span>    GPIO<span style=color:#000;font-weight:700>.</span>setup(PIN_TRIGGER, GPIO<span style=color:#000;font-weight:700>.</span>OUT)
</span></span><span style=display:flex><span>    GPIO<span style=color:#000;font-weight:700>.</span>setup(PIN_ECHO, GPIO<span style=color:#000;font-weight:700>.</span>IN)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#0086b3>print</span>(<span style=color:#d14>&#34;wacht 2 seconden tot de sensor stabiel is&#34;</span>)
</span></span><span style=display:flex><span>    sleep(<span style=color:#099>2</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#0086b3>print</span>(<span style=color:#d14>&#34;maak puls&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#0086b3>print</span>(<span style=color:#d14>&#34;start een klok zodra het begin van de echo wordt gemeten&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    GPIO<span style=color:#000;font-weight:700>.</span>output(PIN_TRIGGER, GPIO<span style=color:#000;font-weight:700>.</span>HIGH)
</span></span><span style=display:flex><span>    sleep(<span style=color:#099>0.00001</span>)
</span></span><span style=display:flex><span>    GPIO<span style=color:#000;font-weight:700>.</span>output(PIN_TRIGGER, GPIO<span style=color:#000;font-weight:700>.</span>LOW)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>while</span> GPIO<span style=color:#000;font-weight:700>.</span>input(PIN_ECHO) <span style=color:#000;font-weight:700>==</span> <span style=color:#099>0</span>:
</span></span><span style=display:flex><span>        puls_start_tijd <span style=color:#000;font-weight:700>=</span> time()
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>while</span> GPIO<span style=color:#000;font-weight:700>.</span>input(PIN_ECHO) <span style=color:#000;font-weight:700>==</span> <span style=color:#099>1</span>:
</span></span><span style=display:flex><span>        puls_eind_tijd <span style=color:#000;font-weight:700>=</span> time()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#0086b3>print</span>(<span style=color:#d14>&#34;stop de klok als de echo voorbij is&#34;</span>)
</span></span><span style=display:flex><span>    puls_duur <span style=color:#000;font-weight:700>=</span> puls_eind_tijd <span style=color:#000;font-weight:700>-</span> puls_start_tijd
</span></span><span style=display:flex><span>    afstand <span style=color:#000;font-weight:700>=</span> <span style=color:#0086b3>round</span>(puls_duur <span style=color:#000;font-weight:700>*</span> GELUIDSSNELHEID <span style=color:#000;font-weight:700>/</span> <span style=color:#099>2</span>, <span style=color:#099>2</span>)
</span></span><span style=display:flex><span>    <span style=color:#0086b3>print</span>(<span style=color:#d14>f</span><span style=color:#d14>&#34;gemeten afstand: </span><span style=color:#d14>{</span>afstand<span style=color:#d14>}</span><span style=color:#d14>cm</span><span style=color:#d14>\n\n</span><span style=color:#d14>&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>finally</span>:
</span></span><span style=display:flex><span>    GPIO<span style=color:#000;font-weight:700>.</span>cleanup()
</span></span></code></pre></div><h4 id=inputoutput-pinnen-gebruiken>Input/Output pinnen gebruiken</h4><p>Op de Rasberry Pi zitten twee rijen met pinnetjes waar je van alles op aan kunt sluiten. In deze code gebruiken we alleen
I/O-pinnen. Ofwel, de pinnen kunnen geen spanning (0) of de maximale spanning (1) uitsturen. Ook kunnen ze alleen maar meten
of de spanning 0V (0) of maximaal 3.3V (1) is.</p><p>De pinnen zijn instelbaar op verschillende manieren, dus als je ze wilt gebruiken, zul je de juiste instelling
moeten gebruiken:</p><ul><li>De software voor het gebruik van de I/O-pinnen importeren:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>PRi.GPIO</span> <span style=color:#000;font-weight:700>as</span> <span style=color:#555>GPIO</span>
</span></span></code></pre></div><ul><li>Pin nummering modus:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>GPIO<span style=color:#000;font-weight:700>.</span>setmode(GPIO<span style=color:#000;font-weight:700>.</span>BOARD)
</span></span></code></pre></div><p>Bij <code>GPIO.BOARD</code> komen de pin nummers in de code overeen met die van de header op het bordje. Voor de andere modus
<code>GPIO.BCM</code> komen de nummers overeen met die van de chip die wordt gebruikt. Dat is een stuk lastiger, dus we gebruiken
<code>GPIO.BOARD</code>.</p><ul><li>De gebruikte pinnen instellen:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>GPIO<span style=color:#000;font-weight:700>.</span>setup(PIN_TRIGGER, GPIO<span style=color:#000;font-weight:700>.</span>OUT)
</span></span><span style=display:flex><span>GPIO<span style=color:#000;font-weight:700>.</span>setup(PIN_ECHO, GPIO<span style=color:#000;font-weight:700>.</span>IN)
</span></span></code></pre></div><p>Variabelen <code>PIN_TRIGGER</code> en <code>PIN_ECHO</code> zijn makkelijk te lezen, maar bevatten de waarden 7 en 11. Ofwel <code>pin 7</code> en <code>pin 11</code>.<br><code>PIN_TRIGGER</code> wordt ingesteld als output met <code>GPIO.OUT</code> en kan dus een spanning van 0V of 3.3V leveren.<br><code>PIN_ECHO</code> wordt gebruikt als input met <code>GPIO.IN</code> en kan juist meten of het signaal hoog of laag is.</p><ul><li><code>PIN_TRIGGER</code> hoog of laag zetten:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>GPIO<span style=color:#000;font-weight:700>.</span>output(PIN_TRIGGER, GPIO<span style=color:#000;font-weight:700>.</span>HIGH)
</span></span><span style=display:flex><span>GPIO<span style=color:#000;font-weight:700>.</span>output(PIN_TRIGGER, GPIO<span style=color:#000;font-weight:700>.</span>LOW)
</span></span></code></pre></div><p>Met <code>GPIO.HIGH</code> of <code>GPIO.LOW</code> kun je pin <code>PIN_TRIGGER</code> hoog of laag zetten.</p><ul><li><code>PIN_ECHO</code> uitlezen:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>pin_waarde <span style=color:#000;font-weight:700>=</span> GPIO<span style=color:#000;font-weight:700>.</span>input(PIN_ECHO)
</span></span></code></pre></div><p><code>pin_waarde</code> krijgt de waarden van <code>PIN_ECHO</code>, een 1 als er een hoge spanning op de pin staat en een 0 als er geen
spanning op staat.</p><ul><li>Pin instellingen weer terugzetten:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>GPIO<span style=color:#000;font-weight:700>.</span>cleanup()
</span></span></code></pre></div><h4 id=hoe-werkt-het-afstand-meten-eigenlijk>Hoe werkt het afstand meten eigenlijk?</h4><p>Met dit stukje code laat je de sensor een ultrasoon signaal maken.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>GPIO<span style=color:#000;font-weight:700>.</span>output(PIN_TRIGGER, GPIO<span style=color:#000;font-weight:700>.</span>HIGH)
</span></span><span style=display:flex><span>sleep(<span style=color:#099>0.00001</span>)
</span></span><span style=display:flex><span>GPIO<span style=color:#000;font-weight:700>.</span>output(PIN_TRIGGER, GPIO<span style=color:#000;font-weight:700>.</span>LOW)
</span></span></code></pre></div><p>De duur van het <code>echo</code>-signaal van de sensor is een maat voor de duur van de echo en daarmee van de afstand. Hoe groter
de afstand is, hoe langer de echo duurt en daarmee het <code>echo</code>-signaal op <code>PIN_ECHO</code>.<br>Met de volgende code kunnen we meten hoe lang het <code>echo</code>-signaal duurt:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>while</span> GPIO<span style=color:#000;font-weight:700>.</span>input(PIN_ECHO) <span style=color:#000;font-weight:700>==</span> <span style=color:#099>0</span>:
</span></span><span style=display:flex><span>    puls_start_tijd <span style=color:#000;font-weight:700>=</span> time()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>while</span> GPIO<span style=color:#000;font-weight:700>.</span>input(PIN_ECHO) <span style=color:#000;font-weight:700>==</span> <span style=color:#099>1</span>:
</span></span><span style=display:flex><span>    puls_eind_tijd <span style=color:#000;font-weight:700>=</span> time()
</span></span></code></pre></div><p>Het eerste stukje wacht tot het begin van het <code>echo</code>-signaal begint.
Dan wordt <code>puls_start_tijd</code> niet meer bijgewerkt en de laatst gevonden tijd bewaard.<br>De volgende <code>while</code> wordt dan uitgevoerd en als het <code>echo</code>-signaal stopt, wordt de <code>puls_eind_tijd</code> bewaard.</p><p>Door <code>puls_start_tijd</code> van <code>puls_eind_tijd</code> af te trekken, weet je hoe lang de echo duurde. De snelheid van ultrasoon
geluid (ultrageluid) is 34300 cm/s. Het geluid gaat van de sensor naar het object en dan weer terug, dus de afstand is gelijk aan:</p><pre tabindex=0><code>afstand = snelheid ultrasoon geluid * duur echo / 2
</code></pre><p>Omdat het geluid heen-en-weer gaat, wordt het resultaat door 2 gedeeld:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>puls_duur <span style=color:#000;font-weight:700>=</span> puls_eind_tijd <span style=color:#000;font-weight:700>-</span> puls_start_tijd
</span></span><span style=display:flex><span>afstand <span style=color:#000;font-weight:700>=</span> <span style=color:#0086b3>round</span>(puls_duur <span style=color:#000;font-weight:700>*</span> GELUIDSSNELHEID <span style=color:#000;font-weight:700>/</span> <span style=color:#099>2</span>, <span style=color:#099>2</span>)
</span></span></code></pre></div><h3 id=zelf-proberen>Zelf proberen</h3><p>De code meet nu een enkele keer de afstand en sluit dan af. Kun je de code zo aanpassen dat de code de meting
bijvoorbeeld iedere seconde herhaalt en je kunt zien dat de afstand varieert als je je hand beweegt?<br>Is er een maximum afstand die je kunt meten?</p><p>Als je de afstand meerdere keren achter elkaar meet, zou je ook kunnen uitrekenen wat de snelheid was van de beweging
tussen de twee metingen. Hoe zou je dat kunnen doen?</p><h2 id=bron>Bron</h2><p>Deze instructie is gebaseerd op het <a href=https://mjrobot.org/rpi-gpiozero/>werk</a> van Marcelo Rovai en de
<a href=https://pimylifeup.com/raspberry-pi-distance-sensor/>instructie</a> van
Gus van <a href=https://pimylifeup.com/>PiMyLifeUp</a>.</p><ul><li><a href=https://mjrobot.org/rpi-gpiozero/>https://mjrobot.org/rpi-gpiozero/</a></li><li><a href=https://pimylifeup.com/>https://pimylifeup.com/</a></li></ul><div class=section id=licentie><h1>Licentie</h1><p>Deze instructies worden, net als alle andere instructies van CoderDojo Nijmegen,
aangeboden onder een <a class="reference external" href=http://creativecommons.org/licenses/by-nc-sa/4.0/>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International Licentie</a>.</p><a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/><img alt="Creative Commons License" style=border-width:0 src=/imgs/CreativeCommons.png></a></div></article></main><footer><div id=colofon><div><p>Stichting CoderDojo Nijmegen</p>Nijhoffstraat 5<br>6524 AT Nijmegen<br><br><a href=/privacy>privacybeleid</a></div><div><img src=/imgs/coderdojo-nijmegen-anbi.png alt="ANBI logo"></div><div><p>hosting door:</p><a href=https://github.com/coderdojonijmegen/ target=_blank rel="noopener noreferrer"><img src=/imgs/GitHub_Logo_White.png alt="Hosting door GitHub Pages"></a></div><div><p>gesteund door:</p><a href=http://www.stitpro.nl/ target=_blank rel="noopener noreferrer"><img src=/imgs/stitpro-bw.png alt="Stitpro logo"></a><br><a href=http://ixperium.nl/ target=_blank rel="noopener noreferrer"><img src=/imgs/ixperium-bw.png alt="Ixperium logo"></a></div></div><div class=copyright>CoderDojo Nijmegen &copy; 2025</div><div class=social><a href=https://www.facebook.com/pages/CoderDojo-Nijmegen/400380873445793 target=_blank rel="noopener noreferrer"><img src=/imgs/facebook.png alt=Facebook></a>
<a href=https://twitter.com/CoderDojo024 target=_blank rel="noopener noreferrer"><img src=/imgs/twitter.png alt=Twitter></a>
<a href=https://www.linkedin.com/company/stichting-coderdojo-nijmegen/ target=_blank rel="noopener noreferrer"><img src=/imgs/linkedin.png alt=LinkedIn></a>
<a href=https://www.eventbrite.nl/o/stichting-coderdojo-nijmegen-12043791497 target=_blank rel="noopener noreferrer"><img src=/imgs/eventbrite.png alt=Eventbrite></a>
<a href=https://github.com/coderdojonijmegen target=_blank rel="noopener noreferrer"><img src=/imgs/github.png alt=GitHub></a></div></footer><script src=/js/bundle.js></script></body></html>